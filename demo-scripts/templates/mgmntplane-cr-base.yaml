---
apiVersion: install.tetrate.io/v1alpha1
kind: ManagementPlane
metadata:
  namespace: tsb
  name: tsbmgmtplane
spec:
  hub: $REPO_MP
  organization: $ORG
  dataStore:
    postgres:
      address: $(kubectl -n tsb get secrets tsb-pguser-tsb -o go-template='{{.data.host | base64decode}}'):$(kubectl -n tsb get secrets tsb-pguser-tsb -o go-template='{{.data.port | base64decode}}')
      name: $(kubectl -n tsb get secrets tsb-pguser-tsb -o go-template='{{.data.dbname | base64decode}}')
      sslMode: disable
  telemetryStore:
    elastic:
      host: $(kubectl -n tsb get svc tsb-es-http -o go-template='{{.metadata.name}}')
      port: 9200
      protocol: http
      version: 7