apiVersion: elasticsearch.k8s.elastic.co/v1
kind: Elasticsearch
metadata:
 name: tsb 
 namespace: tsb 
spec:
 version: 7.13.2
 http:
   service:
     spec:
       type: LoadBalancer
 nodeSets:
   - name: master
     count: 1
     config:
       node.master: true
       node.data: false
       node.ingest: false
     podTemplate:
        spec:
          containers:
            - env:
                - name: ES_JAVA_OPTS
                  value: -Xmx4g -Xms4g
              name: elasticsearch
              resources:
                limits:
                  memory: 6Gi
   - name: data
     count: 3
     config:
       node.master: false
       node.data: true
       node.ingest: true
     podTemplate:
        spec:
          containers:
            - env:
                - name: ES_JAVA_OPTS
                  value: -Xmx4g -Xms4g
              name: elasticsearch
              resources:
                limits:
                  memory: 6Gi
     volumeClaimTemplates:
       - metadata:
           name: elasticsearch-data
         spec:
           accessModes:
             - ReadWriteOnce
           resources:
             requests:
               storage: 1Gi
---
apiVersion: kibana.k8s.elastic.co/v1
kind: Kibana
metadata:
 name: tsb
 namespace: tsb
spec:
 version: 7.10.0
 count: 1
 elasticsearchRef:
   name: tsb
 http:
   service:
     spec:
       type: LoadBalancer

